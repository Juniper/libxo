
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Encoders &#8212; libxo 1.5.1
 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The “xo” Utility" href="xo.html" />
    <link rel="prev" title="The libxo API" href="api.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="xo.html" title="The “xo” Utility"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="api.html" title="The libxo API"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">libxo 1.5.1
 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">On This Page</a></h3>
  <ul>
<li><a class="reference internal" href="#">Encoders</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#csv-comma-separated-values">CSV - Comma Separated Values</a><ul>
<li><a class="reference internal" href="#the-path-option">The <code class="code docutils literal notranslate"><span class="pre">path</span></code> Option</a></li>
<li><a class="reference internal" href="#the-leafs-option">The <code class="code docutils literal notranslate"><span class="pre">leafs</span></code> Option</a></li>
<li><a class="reference internal" href="#the-no-header-option">The <code class="code docutils literal notranslate"><span class="pre">no-header</span></code> Option</a></li>
<li><a class="reference internal" href="#the-no-quotes-option">The <code class="code docutils literal notranslate"><span class="pre">no-quotes</span></code> Option</a></li>
<li><a class="reference internal" href="#the-dos-option">The <code class="code docutils literal notranslate"><span class="pre">dos</span></code> Option</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-encoder-api">The Encoder API</a></li>
</ul>
</li>
</ul>

  <h3><a href="index.html">Full Documentation</a></h3>
  <h4>Previous topic</h4>
  <p class="topless"><a href="api.html"
                        title="previous chapter">The libxo API</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="xo.html"
                        title="next chapter">The “xo” Utility</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/encoders.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="encoders">
<span id="index-0"></span><h1>Encoders<a class="headerlink" href="#encoders" title="Permalink to this headline">¶</a></h1>
<p>This section gives an overview of encoders, details on the encoders
that ship with libxo, and documentation for developers of future
encoders.</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The libxo library contains software to generate four “built-in”
formats: text, XML, JSON, and HTML.  These formats are common and
useful, but there are other common and useful formats that users will
want, and including them all in the libxo software would be difficult
and cumbersome.</p>
<p>To allow support for additional encodings, libxo includes a
“pluggable” extension mechanism for dynamically loading new encoders.
libxo-based applications can automatically use any installed encoder.</p>
<p>Use the “encoder=XXX” option to access encoders.  The following
example uses the “cbor” encoder, saving the output into a file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">--</span><span class="n">libxo</span> <span class="n">encoder</span><span class="o">=</span><span class="n">cbor</span> <span class="o">&gt;</span> <span class="n">df</span><span class="o">-</span><span class="n">output</span><span class="o">.</span><span class="n">cbor</span>
</pre></div>
</div>
<p>Encoders can support specific options that can be accessed by
following the encoder name with a colon (‘:’) or a plus sign (‘+’) and
one of more options, separated by the same character:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">--</span><span class="n">libxo</span> <span class="n">encoder</span><span class="o">=</span><span class="n">csv</span><span class="o">+</span><span class="n">path</span><span class="o">=</span><span class="n">filesystem</span><span class="o">+</span><span class="n">leaf</span><span class="o">=</span><span class="n">name</span><span class="o">+</span><span class="n">no</span><span class="o">-</span><span class="n">header</span>
<span class="n">df</span> <span class="o">--</span><span class="n">libxo</span> <span class="n">encoder</span><span class="o">=</span><span class="n">csv</span><span class="p">:</span><span class="n">path</span><span class="o">=</span><span class="n">filesystem</span><span class="p">:</span><span class="n">leaf</span><span class="o">=</span><span class="n">name</span><span class="p">:</span><span class="n">no</span><span class="o">-</span><span class="n">header</span>
</pre></div>
</div>
<p>These examples instructs libxo to load the “csv” encoder and pass the
following options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">path</span><span class="o">=</span><span class="n">filesystem</span>
<span class="n">leaf</span><span class="o">=</span><span class="n">name</span>
<span class="n">no</span><span class="o">-</span><span class="n">header</span>
</pre></div>
</div>
<p>Each of these option is interpreted by the encoder, and all such
options names and semantics are specific to the particular encoder.
Refer to the intended encoder for documentation on its options.</p>
<p>The string “&#64;” can be used in place of the string “encoder=”.</p>
<blockquote>
<div><p>df –libxo &#64;csv:no-header</p>
</div></blockquote>
</div>
<div class="section" id="csv-comma-separated-values">
<span id="csv-encoder"></span><h2>CSV - Comma Separated Values<a class="headerlink" href="#csv-comma-separated-values" title="Permalink to this headline">¶</a></h2>
<p>libxo ships with a custom encoder for “CSV” files, a common format for
comma separated values.  The output of the CSV encoder can be loaded
directly into spreadsheets or similar applications.</p>
<p>A standard for CSV files is provided in <span class="target" id="index-1"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc4180.html"><strong>RFC 4180</strong></a>, but since the
format predates that standard by decades, there are many minor
differences in CSV file consumers and their expectations.  The CSV
encoder has a number of options to tailor output to those
expectations.</p>
<p>Consider the following XML:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="nb">list</span><span class="o">-</span><span class="n">items</span> <span class="o">--</span><span class="n">libxo</span> <span class="n">xml</span><span class="p">,</span><span class="n">pretty</span>
<span class="o">&lt;</span><span class="n">top</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">data</span> <span class="n">test</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">item</span> <span class="n">test2</span><span class="o">=</span><span class="s2">&quot;value2&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">sku</span> <span class="n">test3</span><span class="o">=</span><span class="s2">&quot;value3&quot;</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="o">&gt;</span><span class="n">GRO</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">415</span><span class="o">&lt;/</span><span class="n">sku</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">name</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="o">&gt;</span><span class="n">gum</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">sold</span><span class="o">&gt;</span><span class="mi">1412</span><span class="o">&lt;/</span><span class="n">sold</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="ow">in</span><span class="o">-</span><span class="n">stock</span><span class="o">&gt;</span><span class="mi">54</span><span class="o">&lt;/</span><span class="ow">in</span><span class="o">-</span><span class="n">stock</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">on</span><span class="o">-</span><span class="n">order</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">on</span><span class="o">-</span><span class="n">order</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">item</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">item</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">sku</span> <span class="n">test3</span><span class="o">=</span><span class="s2">&quot;value3&quot;</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="o">&gt;</span><span class="n">HRD</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">212</span><span class="o">&lt;/</span><span class="n">sku</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">name</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="o">&gt;</span><span class="n">rope</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">sold</span><span class="o">&gt;</span><span class="mi">85</span><span class="o">&lt;/</span><span class="n">sold</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="ow">in</span><span class="o">-</span><span class="n">stock</span><span class="o">&gt;</span><span class="mi">4</span><span class="o">&lt;/</span><span class="ow">in</span><span class="o">-</span><span class="n">stock</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">on</span><span class="o">-</span><span class="n">order</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;/</span><span class="n">on</span><span class="o">-</span><span class="n">order</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">item</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">item</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">sku</span> <span class="n">test3</span><span class="o">=</span><span class="s2">&quot;value3&quot;</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="o">&gt;</span><span class="n">HRD</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">517</span><span class="o">&lt;/</span><span class="n">sku</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">name</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="o">&gt;</span><span class="n">ladder</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">sold</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">&lt;/</span><span class="n">sold</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="ow">in</span><span class="o">-</span><span class="n">stock</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;/</span><span class="ow">in</span><span class="o">-</span><span class="n">stock</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">on</span><span class="o">-</span><span class="n">order</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">on</span><span class="o">-</span><span class="n">order</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">item</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">data</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">top</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This output is a list of <code class="code docutils literal notranslate"><span class="pre">instances</span></code> (named “item”), each containing a
set of <code class="code docutils literal notranslate"><span class="pre">leafs</span></code> (“sku”, “name”, etc).</p>
<p>The CSV encoder will emit the leaf values in this output as <code class="code docutils literal notranslate"><span class="pre">fields</span></code>
inside a CSV <code class="code docutils literal notranslate"><span class="pre">record</span></code>, which is a line containing a set of
comma-separated values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="nb">list</span><span class="o">-</span><span class="n">items</span> <span class="o">--</span><span class="n">libxo</span> <span class="n">encoder</span><span class="o">=</span><span class="n">csv</span>
<span class="n">sku</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">sold</span><span class="p">,</span><span class="ow">in</span><span class="o">-</span><span class="n">stock</span><span class="p">,</span><span class="n">on</span><span class="o">-</span><span class="n">order</span>
<span class="n">GRO</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">415</span><span class="p">,</span><span class="n">gum</span><span class="p">,</span><span class="mi">1412</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">10</span>
<span class="n">HRD</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">212</span><span class="p">,</span><span class="n">rope</span><span class="p">,</span><span class="mi">85</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span>
<span class="n">HRD</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">517</span><span class="p">,</span><span class="n">ladder</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span>
</pre></div>
</div>
<p>Be aware that since the CSV encoder looks for data instances, when
used with <a class="reference internal" href="xo.html#xo"><span class="std std-ref">The “xo” Utility</span></a>, the <code class="code docutils literal notranslate"><span class="pre">--instance</span></code> option will be needed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">xo</span> <span class="o">--</span><span class="n">libxo</span> <span class="n">encoder</span><span class="o">=</span><span class="n">csv</span> <span class="o">--</span><span class="n">instance</span> <span class="n">foo</span> <span class="s1">&#39;The {:product} is {:status}</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="n">stereo</span> <span class="s2">&quot;in route&quot;</span>
<span class="n">product</span><span class="p">,</span><span class="n">status</span>
<span class="n">stereo</span><span class="p">,</span><span class="ow">in</span> <span class="n">route</span>
</pre></div>
</div>
<div class="section" id="the-path-option">
<span id="csv-path"></span><h3>The <code class="code docutils literal notranslate"><span class="pre">path</span></code> Option<a class="headerlink" href="#the-path-option" title="Permalink to this headline">¶</a></h3>
<p>By default, the CSV encoder will attempt to emit any list instance
generated by the application.  In some cases, this may be
unacceptable, and a specific list may be desired.</p>
<p>Use the “path” option to limit the processing of output to a specific
hierarchy.  The path should be one or more names of containers or
lists.</p>
<p>For example, if the “list-items” application generates other lists,
the user can give “path=top/data/item” as a path:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="nb">list</span><span class="o">-</span><span class="n">items</span> <span class="o">--</span><span class="n">libxo</span> <span class="n">encoder</span><span class="o">=</span><span class="n">csv</span><span class="p">:</span><span class="n">path</span><span class="o">=</span><span class="n">top</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">item</span>
<span class="n">sku</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">sold</span><span class="p">,</span><span class="ow">in</span><span class="o">-</span><span class="n">stock</span><span class="p">,</span><span class="n">on</span><span class="o">-</span><span class="n">order</span>
<span class="n">GRO</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">415</span><span class="p">,</span><span class="n">gum</span><span class="p">,</span><span class="mi">1412</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">10</span>
<span class="n">HRD</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">212</span><span class="p">,</span><span class="n">rope</span><span class="p">,</span><span class="mi">85</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span>
<span class="n">HRD</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">517</span><span class="p">,</span><span class="n">ladder</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span>
</pre></div>
</div>
<p>Paths are “relative”, meaning they need not be a complete set
of names to the list.  This means that “path=item” may be sufficient
for the above example.</p>
</div>
<div class="section" id="the-leafs-option">
<span id="csv-leafs"></span><h3>The <code class="code docutils literal notranslate"><span class="pre">leafs</span></code> Option<a class="headerlink" href="#the-leafs-option" title="Permalink to this headline">¶</a></h3>
<p>The CSV encoding requires that all lines of output have the same
number of fields with the same order.  In contrast, XML and JSON allow
any order (though libxo forces key leafs to appear before other
leafs).</p>
<p>To maintain a consistent set of fields inside the CSV file, the same
set of leafs must be selected from each list item.  By default, the
CSV encoder records the set of leafs that appear in the first list
instance it processes, and extract only those leafs from future
instances.  If the first instance is missing a leaf that is desired by
the consumer, the “leaf” option can be used to ensure that an empty
value is recorded for instances that lack a particular leaf.</p>
<p>The “leafs” option can also be used to exclude leafs, limiting the
output to only those leafs provided.</p>
<p>In addition, the order of the output fields follows the order in which
the leafs are listed.  “leafs=one.two” and “leafs=two.one” give
distinct output.</p>
<p>So the “leafs” option can be used to expand, limit, and order the set
of leafs.</p>
<p>The value of the leafs option should be one or more leaf names,
separated by a period (“.”):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="nb">list</span><span class="o">-</span><span class="n">items</span> <span class="o">--</span><span class="n">libxo</span> <span class="n">encoder</span><span class="o">=</span><span class="n">csv</span><span class="p">:</span><span class="n">leafs</span><span class="o">=</span><span class="n">sku</span><span class="o">.</span><span class="n">on</span><span class="o">-</span><span class="n">order</span>
<span class="n">sku</span><span class="p">,</span><span class="n">on</span><span class="o">-</span><span class="n">order</span>
<span class="n">GRO</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">415</span><span class="p">,</span><span class="mi">10</span>
<span class="n">HRD</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">212</span><span class="p">,</span><span class="mi">2</span>
<span class="n">HRD</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">517</span><span class="p">,</span><span class="mi">1</span>
<span class="o">%</span> <span class="nb">list</span><span class="o">-</span><span class="n">items</span> <span class="o">-</span><span class="n">libxo</span> <span class="n">encoder</span><span class="o">=</span><span class="n">csv</span><span class="p">:</span><span class="n">leafs</span><span class="o">=</span><span class="n">on</span><span class="o">-</span><span class="n">order</span><span class="o">.</span><span class="n">sku</span>
<span class="n">on</span><span class="o">-</span><span class="n">order</span><span class="p">,</span><span class="n">sku</span>
<span class="mi">10</span><span class="p">,</span><span class="n">GRO</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">415</span>
<span class="mi">2</span><span class="p">,</span><span class="n">HRD</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">212</span>
<span class="mi">1</span><span class="p">,</span><span class="n">HRD</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">517</span>
</pre></div>
</div>
<p>Note that since libxo uses terminology from YANG (<span class="target" id="index-2"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc7950.html"><strong>RFC 7950</strong></a>), the
data modeling language for NETCONF (<span class="target" id="index-3"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc6241.html"><strong>RFC 6241</strong></a>), which uses “leafs”
as the plural form of “leaf”.  libxo follows that convention.</p>
</div>
<div class="section" id="the-no-header-option">
<span id="csv-no-header"></span><h3>The <code class="code docutils literal notranslate"><span class="pre">no-header</span></code> Option<a class="headerlink" href="#the-no-header-option" title="Permalink to this headline">¶</a></h3>
<p>CSV files typical begin with a line that defines the fields included
in that file, in an attempt to make the contents self-defining:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sku</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">sold</span><span class="p">,</span><span class="ow">in</span><span class="o">-</span><span class="n">stock</span><span class="p">,</span><span class="n">on</span><span class="o">-</span><span class="n">order</span>
<span class="n">GRO</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">415</span><span class="p">,</span><span class="n">gum</span><span class="p">,</span><span class="mi">1412</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">10</span>
<span class="n">HRD</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">212</span><span class="p">,</span><span class="n">rope</span><span class="p">,</span><span class="mi">85</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span>
<span class="n">HRD</span><span class="o">-</span><span class="mi">000</span><span class="o">-</span><span class="mi">517</span><span class="p">,</span><span class="n">ladder</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span>
</pre></div>
</div>
<p>There is no reliable mechanism for determining whether this header
line is included, so the consumer must make an assumption.</p>
<p>The csv encoder defaults to producing the header line, but the
“no-header” option can be included to avoid the header line.</p>
</div>
<div class="section" id="the-no-quotes-option">
<span id="csv-no-quotes"></span><h3>The <code class="code docutils literal notranslate"><span class="pre">no-quotes</span></code> Option<a class="headerlink" href="#the-no-quotes-option" title="Permalink to this headline">¶</a></h3>
<p><span class="target" id="index-4"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc4180.html"><strong>RFC 4180</strong></a> specifies that fields containing spaces should be quoted, but
many CSV consumers do not handle quotes.  The “no-quotes” option
instruct the CSV encoder to avoid the use of quotes.</p>
</div>
<div class="section" id="the-dos-option">
<span id="csv-dos"></span><h3>The <code class="code docutils literal notranslate"><span class="pre">dos</span></code> Option<a class="headerlink" href="#the-dos-option" title="Permalink to this headline">¶</a></h3>
<p><span class="target" id="index-5"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc4180.html"><strong>RFC 4180</strong></a> defines the end-of-line marker as a carriage return
followed by a newline.  This <code class="code docutils literal notranslate"><span class="pre">CRLF</span></code> convention dates from the distant
past, but its use was anchored in the 1980s by the <code class="code docutils literal notranslate"><span class="pre">DOS</span></code> operating
system.</p>
<p>The CSV encoder defaults to using the standard Unix end-of-line
marker, a simple newline.  Use the “dos” option to use the <code class="code docutils literal notranslate"><span class="pre">CRLF</span></code>
convention.</p>
</div>
</div>
<div class="section" id="the-encoder-api">
<h2>The Encoder API<a class="headerlink" href="#the-encoder-api" title="Permalink to this headline">¶</a></h2>
<p>The encoder API consists of three distinct phases:</p>
<ul class="simple">
<li><p>loading the encoder</p></li>
<li><p>initializing the encoder</p></li>
<li><p>feeding operations to the encoder</p></li>
</ul>
<p>To load the encoder, libxo will open a shared library named:</p>
<blockquote>
<div><p>${prefix}/lib/libxo/encoder/${name}.enc</p>
</div></blockquote>
<p>This file is typically a symbolic link to a dynamic library, suitable
for <code class="code docutils literal notranslate"><span class="pre">dlopen`().</span>&#160; <span class="pre">libxo</span> <span class="pre">looks</span> <span class="pre">for</span> <span class="pre">a</span> <span class="pre">symbol</span> <span class="pre">called</span>
<span class="pre">`xo_encoder_library_init</span></code> inside that library and calls it with the
arguments defined in the header file “xo_encoder.h”.  This function
should look as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span>
<span class="n">xo_encoder_library_init</span> <span class="p">(</span><span class="n">XO_ENCODER_INIT_ARGS</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">arg</span><span class="o">-&gt;</span><span class="n">xei_version</span> <span class="o">=</span> <span class="n">XO_ENCODER_VERSION</span><span class="p">;</span>
    <span class="n">arg</span><span class="o">-&gt;</span><span class="n">xei_handler</span> <span class="o">=</span> <span class="n">test_handler</span><span class="p">;</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Several features here allow for future compatibility: the macro
XO_ENCODER_INIT_ARGS allows the arguments to this function change over
time, and the XO_ENCODER_VERSION allows the library to tell libxo
which version of the API it was compiled with.</p>
<p>The function places in xei_handler should be have the signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">static</span> <span class="nb">int</span>
<span class="n">test_handler</span> <span class="p">(</span><span class="n">XO_ENCODER_HANDLER_ARGS</span><span class="p">)</span>
<span class="p">{</span>
     <span class="o">...</span>
</pre></div>
</div>
<p>This function will be called with the “op” codes defined in
“xo_encoder.h”.  Each op code represents a distinct event in the libxo
processing model.  For example OP_OPEN_CONTAINER tells the encoder
that a new container has been opened, and the encoder can behave in an
appropriate manner.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="xo.html" title="The “xo” Utility"
             >next</a> |</li>
        <li class="right" >
          <a href="api.html" title="The libxo API"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">libxo 1.5.1
 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017-2019, Juniper Networks Inc.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.3.0.
    </div>
  </body>
</html>